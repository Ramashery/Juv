<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLOISONNE ENAMEL | Jewelry Showcase</title>
    <meta name="description" content="Explore exclusive handmade cloisonne enamel jewelry by Nino Kartsivadze. Discover unique rings, pendants, and earrings crafted in Tbilisi, Georgia.">
    <style>
        /* –°—Ç–∏–ª–∏ –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π. */
        :root {
            --primary: #D4AF37; --primary-dark: #9B7C2E; --bg: #121212;
            --bg-dark: #080808; --glass: rgba(255, 255, 255, 0.05);
            --glass-dark: rgba(0, 0, 0, 0.2); --text-light: rgba(255, 255, 255, 0.9);
            --text-dark: rgba(0, 0, 0, 0.8); --shadow-dark: rgba(0, 0, 0, 0.2);
            --shadow-light: rgba(255, 255, 255, 0.05);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Montserrat', sans-serif; }
        body { background: var(--bg); color: var(--text-light); overflow-x: hidden; min-height: 100vh; position: relative; }
        #particles-js { position: fixed; width: 100%; height: 100%; top: 0; left: 0; z-index: -1; }
        header { padding: 4rem 2rem 2rem; margin-bottom: 3rem; display: flex; flex-direction: column; align-items: center; }
        .logo { font-size: clamp(1.5rem, 6vw, 3.5rem); letter-spacing: clamp(0.15rem, 2vw, 0.5rem); white-space: nowrap; font-weight: 300; color: var(--primary); position: relative; display: inline-block; }
        .logo span { display: inline-block; opacity: 0; transform: translateY(20px); animation: letterAppear 0.8s forwards; }
        @keyframes letterAppear { to { opacity: 1; transform: translateY(0); } }
        .logo span:nth-child(1) { animation-delay: 0.1s; } .logo span:nth-child(2) { animation-delay: 0.2s; } .logo span:nth-child(3) { animation-delay: 0.3s; } .logo span:nth-child(4) { animation-delay: 0.4s; } .logo span:nth-child(5) { animation-delay: 0.5s; } .logo span:nth-child(6) { animation-delay: 0.6s; } .logo span:nth-child(7) { animation-delay: 0.7s; } .logo span:nth-child(8) { animation-delay: 0.8s; } .logo span:nth-child(9) { animation-delay: 0.9s; } .logo span:nth-child(10) { animation-delay: 1.0s; } .logo span:nth-child(11) { animation-delay: 1.1s; } .logo span:nth-child(12) { animation-delay: 1.2s; } .logo span:nth-child(13) { animation-delay: 1.3s; } .logo span:nth-child(14) { animation-delay: 1.4s; }
        .subtitle { margin-top: 1rem; font-weight: 300; letter-spacing: 0.3rem; opacity: 0; transform: translateY(20px); animation: fadeInUp 1s 1.5s forwards; }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 2rem; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 2rem; margin-bottom: 4rem; }
        .product-card { background: var(--glass); border-radius: 24px; box-shadow: 8px 8px 16px var(--shadow-dark), -8px -8px 16px var(--shadow-light); backdrop-filter: blur(12px); transition: transform 0.4s, box-shadow 0.4s; overflow: hidden; opacity: 0; transform: translateY(30px); animation: cardAppear 0.8s forwards; animation-delay: calc(var(--delay) * 0.1s); position: relative; border: 1px solid rgba(212, 175, 55, 0.1); }
        @keyframes cardAppear { to { opacity: 1; transform: translateY(0); } }
        .product-card:hover { transform: translateY(-8px); box-shadow: 12px 12px 24px var(--shadow-dark), -12px -12px 24px var(--shadow-light); }
        .slideshow-container { width: 100%; height: 250px; position: relative; overflow: hidden; -webkit-mask-image: -webkit-radial-gradient(white, black); }
        .product-image-container { clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%); transition: clip-path 0.5s ease; }
        .product-card:hover .product-image-container { clip-path: polygon(0 0, 100% 0, 100% 100%, 0 85%); }
        .slideshow-item { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 0.7s ease-in-out; pointer-events: none; }
        .slideshow-item.active { opacity: 1; }
        .slideshow-item-video { width: 140%; height: 140%; top: -20%; left: -20%; }
        .slideshow-item-video iframe { width: 100%; height: 100%; border: none; }
        .slideshow-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; cursor: grab; }
        .product-info { padding: 1.5rem; }
        .product-title { font-size: 1.2rem; margin-bottom: 0.5rem; color: var(--primary); }
        .product-price { font-weight: 700; margin-bottom: 1rem; }
        .gold-button { display: inline-block; text-decoration: none; text-align: center; background: none; border: none; color: var(--primary); padding: 0.8rem 1.5rem; font-size: 1rem; border-radius: 50px; position: relative; overflow: hidden; cursor: pointer; z-index: 1; transition: color 0.3s; border: 1px solid rgba(212, 175, 55, 0.3); box-shadow: 4px 4px 8px var(--shadow-dark), -4px -4px 8px var(--shadow-light); }
        .gold-button::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--primary); z-index: -1; clip-path: circle(0% at 50% 50%); transition: clip-path 0.5s ease; }
        .gold-button:hover { color: var(--bg); }
        .gold-button:hover::before { clip-path: circle(100% at 50% 50%); }
        nav { display: flex; justify-content: center; margin-bottom: 3rem; flex-wrap: wrap; gap: 1rem; }
        .nav-link { margin: 0 1rem; color: var(--text-light); text-decoration: none; position: relative; padding: 0.5rem 0; opacity: 0; animation: fadeIn 1s forwards; animation-delay: calc(var(--delay) * 0.2s); }
        @keyframes fadeIn { to { opacity: 1; } }
        .nav-link::after { content: ''; position: absolute; bottom: 0; left: 0; width: 0; height: 1px; background: var(--primary); transition: width 0.3s ease; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        footer { text-align: center; padding: 2rem; margin-top: 4rem; opacity: 0; animation: fadeIn 1s 1.5s forwards; }
        .admin-trigger-footer { cursor: pointer; transition: color 0.3s ease; }
        .admin-trigger-footer:hover { color: var(--primary); }
        .admin-panel-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px); z-index: 9998; display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: all 0.5s; }
        .admin-panel-overlay.active { opacity: 1; visibility: visible; }
        .admin-panel-content { background: var(--bg-dark); border-radius: 16px; padding: 2rem; width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3); border: 1px solid rgba(212, 175, 55, 0.2); }
        .admin-panel-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); }
        .admin-panel-title { font-size: 1.5rem; color: var(--primary); }
        .admin-panel-close { background: none; border: none; color: var(--text-light); font-size: 1.5rem; cursor: pointer; }
        .admin-tabs { display: flex; margin-bottom: 1.5rem; border-bottom: 1px solid rgba(212, 175, 55, 0.2); flex-wrap: wrap; }
        .admin-tab { padding: 0.5rem 1rem; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.3s; }
        .admin-tab.active { border-bottom: 2px solid var(--primary); color: var(--primary); }
        .admin-tab-content { display: none; }
        .admin-tab-content.active { display: block; }
        .admin-form-group { margin-bottom: 1.5rem; }
        .admin-form-label { display: block; margin-bottom: 0.5rem; color: var(--primary); }
        .admin-form-input, .admin-form-textarea, .admin-form-select { width: 100%; padding: 0.8rem; background: var(--glass); border: 1px solid rgba(212, 175, 55, 0.2); border-radius: 8px; color: var(--text-light); font-family: inherit; }
        .admin-form-textarea { min-height: 100px; resize: vertical; }
        .admin-form-actions { display: flex; justify-content: flex-end; gap: 1rem; margin-top: 2rem; }
        .admin-button-primary { background: var(--primary); color: var(--bg-dark); border: none; padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .admin-button-primary:hover { background: var(--primary-dark); }
        .admin-button-secondary { background: none; color: var(--primary); border: 1px solid var(--primary); padding: 0.8rem 1.5rem; border-radius: 8px; cursor: pointer; transition: all 0.3s; }
        .admin-button-secondary:hover { background: rgba(212, 175, 55, 0.1); }
        .admin-products-list { display: grid; gap: 1rem; }
        .admin-product-item { background: var(--glass); padding: 1rem; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid rgba(212, 175, 55, 0.1); }
        .admin-product-actions { display: flex; gap: 0.5rem; }
        .admin-product-edit, .admin-product-delete { background: none; border: none; color: var(--text-light); cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: all 0.3s; }
        .admin-product-edit { background: rgba(212, 175, 55, 0.2); } .admin-product-edit:hover { background: rgba(212, 175, 55, 0.4); }
        .admin-product-delete { background: rgba(255, 0, 0, 0.2); } .admin-product-delete:hover { background: rgba(255, 0, 0, 0.4); }
        .admin-categories-list { display: grid; gap: 1rem; }
        .admin-category-item { background: var(--glass); padding: 1rem; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid rgba(212, 175, 55, 0.1); }
        .admin-category-actions { display: flex; gap: 0.5rem; }
        .admin-category-edit, .admin-category-delete { background: none; border: none; color: var(--text-light); cursor: pointer; padding: 0.5rem; border-radius: 4px; transition: all 0.3s; }
        .admin-category-edit { background: rgba(212, 175, 55, 0.2); } .admin-category-edit:hover { background: rgba(212, 175, 55, 0.4); }
        .admin-category-delete { background: rgba(255, 0, 0, 0.2); } .admin-category-delete:hover { background: rgba(255, 0, 0, 0.4); }
        @media (max-width: 768px) { .products-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <header>
        <h1 class="logo"><span>C</span><span>L</span><span>O</span><span>I</span><span>S</span><span>O</span><span>N</span><span>N</span><span>E</span> <span>E</span><span>N</span><span>A</span><span>M</span><span>E</span><span>L</span></h1>
        <p class="subtitle">NINO KARTSIVADZE</p>
    </header>
    <nav></nav>
    <div class="container">
        <div class="products-grid" id="products-container"></div>
    </div>
    <footer>
        <p>¬© 2023 <span id="admin-footer-trigger" class="admin-trigger-footer">CLOISONNE ENAMEL</span>. All rights reserved.</p>
    </footer>

    <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (HTML –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) -->
    <div class="admin-panel-overlay" id="admin-panel">
        <div class="admin-panel-content">
            <div class="admin-panel-header">
                <h2 class="admin-panel-title">Admin Panel</h2>
                <button class="admin-panel-close" id="admin-close">&times;</button>
            </div>
            <div class="admin-tabs">
                <div class="admin-tab active" data-tab="products">Products</div>
                <div class="admin-tab" data-tab="categories">Categories</div>
                <div class="admin-tab" data-tab="about-me">About Me</div>
            </div>
            <div class="admin-tab-content active" id="products-tab">
                <form id="product-form">
                    <input type="hidden" id="product-id">
                    <div class="admin-form-group"><label for="product-title" class="admin-form-label">Title</label><input type="text" id="product-title" class="admin-form-input" required></div>
                    <div class="admin-form-group"><label for="product-category" class="admin-form-label">Category</label><select id="product-category" class="admin-form-select" required><option value="">Select category</option></select></div>
                    <div class="admin-form-group"><label for="product-images" class="admin-form-label">Image or YouTube URLs (one per line)</label><textarea id="product-images" class="admin-form-textarea" required rows="4"></textarea></div>
                    <div class="admin-form-group"><label for="product-description" class="admin-form-label">Description</label><textarea id="product-description" class="admin-form-textarea" required></textarea></div>
                    <div class="admin-form-group"><label for="product-features" class="admin-form-label">Features (one per line)</label><textarea id="product-features" class="admin-form-textarea" required></textarea></div>
                    <div class="admin-form-group"><label for="product-price" class="admin-form-label">Price</label><input type="text" id="product-price" class="admin-form-input" required></div>
                    <div class="admin-form-actions"><button type="button" class="admin-button-secondary" id="product-cancel">Cancel</button><button type="submit" class="admin-button-primary">Save Product</button></div>
                </form>
                <hr style="border-color: rgba(212, 175, 55, 0.2); margin: 2rem 0;">
                <label class="admin-form-label">Product List</label>
                <div class="admin-products-list" id="admin-products-list"></div>
            </div>
            <div class="admin-tab-content" id="categories-tab">
                <form id="category-form">
                    <input type="hidden" id="category-id">
                    <div class="admin-form-group"><label for="category-name" class="admin-form-label">Name</label><input type="text" id="category-name" class="admin-form-input" required></div>
                    <div class="admin-form-actions"><button type="button" class="admin-button-secondary" id="category-cancel">Cancel</button><button type="submit" class="admin-button-primary">Save Category</button></div>
                </form>
                <hr style="border-color: rgba(212, 175, 55, 0.2); margin: 2rem 0;">
                <label class="admin-form-label">Category List</label>
                <div class="admin-categories-list" id="admin-categories-list"></div>
            </div>
            <div class="admin-tab-content" id="about-me-tab">
                <form id="about-me-form">
                    <div class="admin-form-group"><label for="about-me-text-input" class="admin-form-label">Text / Biography</label><textarea id="about-me-text-input" class="admin-form-textarea" rows="10"></textarea></div>
                    <div class="admin-form-group"><label for="about-me-images-input" class="admin-form-label">Image or YouTube URLs (one per line)</label><textarea id="about-me-images-input" class="admin-form-textarea" rows="5"></textarea></div>
                    <div class="admin-form-actions"><button type="submit" class="admin-button-primary">Save "About Me" Content</button></div>
                </form>
            </div>
        </div>
    </div>
    
    <script src="https://www.youtube.com/iframe_api"></script>
    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <script>
        window.onYouTubeIframeAPIReady = function() {
            // Firebase –∏ Particles.js (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
            const firebaseConfig = {
              apiKey: "AIzaSyAxOUOxaufE60eVuyOq_P66MJ9ls_7p470",
              authDomain: "nini-shop-7c89d.firebaseapp.com",
              projectId: "nini-shop-7c89d",
              storageBucket: "nini-shop-7c89d.appspot.com",
              messagingSenderId: "595482257713",
              appId: "1:595482257713:web:3e3d3bf75f03c08e58a810",
              measurementId: "G-0HX4N09DYT"
            };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            const particleConfig = { "particles": { "number": { "value": 80, "density": { "enable": true, "value_area": 800 }}, "color": { "value": "#D4AF37" }, "shape": { "type": "circle" }, "opacity": { "value": 0.5, "random": true, "anim": { "enable": true, "speed": 1, "opacity_min": 0.1 }}, "size": { "value": 3, "random": true, "anim": { "enable": true, "speed": 2, "size_min": 0.1 }}, "line_linked": { "enable": true, "distance": 150, "color": "#D4AF37", "opacity": 0.2, "width": 1 }, "move": { "enable": true, "speed": 1, "direction": "none", "random": true, "out_mode": "out" }}, "interactivity": { "events": { "onhover": { "enable": true, "mode": "grab" }, "onclick": { "enable": true, "mode": "push" }}}, "retina_detect": true };
            particlesJS('particles-js', particleConfig);

            // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
            const adminPanel = document.getElementById('admin-panel');
            let aboutMeContent = { text: '', images: [] };
            let products = {};
            let categories = {};

            // --- –ù–û–í–ê–Ø –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –§–£–ù–ö–¶–ò–Ø –ì–ï–ù–ï–†–ê–¶–ò–ò SLUG ---
            function generateSlug(text) {
                const translit = {
                    '–∞': 'a', '–±': 'b', '–≤': 'v', '–≥': 'g', '–¥': 'd', '–µ': 'e', '—ë': 'e', '–∂': 'zh',
                    '–∑': 'z', '–∏': 'i', '–π': 'y', '–∫': 'k', '–ª': 'l', '–º': 'm', '–Ω': 'n', '–æ': 'o',
                    '–ø': 'p', '—Ä': 'r', '—Å': 's', '—Ç': 't', '—É': 'u', '—Ñ': 'f', '—Ö': 'h', '—Ü': 'c',
                    '—á': 'ch', '—à': 'sh', '—â': 'sch', '—ä': '', '—ã': 'y', '—å': '', '—ç': 'e', '—é': 'yu', '—è': 'ya',
                    '·Éê': 'a', '·Éë': 'b', '·Éí': 'g', '·Éì': 'd', '·Éî': 'e', '·Éï': 'v', '·Éñ': 'z', '·Éó': 't',
                    '·Éò': 'i', '·Éô': 'k', '·Éö': 'l', '·Éõ': 'm', '·Éú': 'n', '·Éù': 'o', '·Éû': 'p', '·Éü': 'zh',
                    '·É†': 'r', '·É°': 's', '·É¢': 't', '·É£': 'u', '·É§': 'p', '·É•': 'k', '·É¶': 'gh', '·Éß': 'q',
                    '·É®': 'sh', '·É©': 'ch', '·É™': 'ts', '·É´': 'dz', '·É¨': 'ts', '·É≠': 'ch', '·ÉÆ': 'kh', '·ÉØ': 'j', '·É∞': 'h'
                };

                return text.toString().toLowerCase()
                    .replace(/\s+/g, '-')
                    .replace(/[^\w-]+/g, char => translit[char] || '')
                    .replace(/--+/g, '-')
                    .replace(/^-+/, '')
                    .replace(/-+$/, '');
            }

            function isYoutubeUrl(url) { return /^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.?be)\/.+$/.test(url); }
            function getYoutubeEmbedUrl(url) {
                let videoId;
                try {
                    const urlObj = new URL(url);
                    videoId = (urlObj.hostname === 'youtu.be') ? urlObj.pathname.slice(1) : urlObj.searchParams.get('v');
                } catch(e) { return null; }
                return videoId ? `https://www.youtube.com/embed/${videoId}?enablejsapi=1&autoplay=1&mute=1&controls=0&loop=1&playlist=${videoId}&origin=${window.location.origin}` : null;
            }

            function setupSlideshow(container) {
                const slides = Array.from(container.querySelectorAll('.slideshow-item'));
                if (slides.length <= 1) {
                    if (slides.length === 1) slides[0].classList.add('active');
                    return;
                }
                const overlay = document.createElement('div');
                overlay.className = 'slideshow-overlay';
                container.appendChild(overlay);
                let currentIndex = 0;
                let intervalId = setInterval(() => showSlide(currentIndex + 1), 4000);

                function showSlide(index) {
                    slides[currentIndex].classList.remove('active');
                    currentIndex = (index + slides.length) % slides.length;
                    slides[currentIndex].classList.add('active');
                }
                
                function manualSlide(direction) {
                    clearInterval(intervalId);
                    showSlide(currentIndex + direction);
                    intervalId = setInterval(() => showSlide(currentIndex + 1), 4000);
                }
                
                let touchStartX = 0;
                overlay.addEventListener('mousedown', e => touchStartX = e.clientX);
                overlay.addEventListener('mouseup', e => {
                    if (e.clientX < touchStartX - 50) manualSlide(1);
                    if (e.clientX > touchStartX + 50) manualSlide(-1);
                });
                overlay.addEventListener('touchstart', e => touchStartX = e.touches[0].clientX, { passive: true });
                overlay.addEventListener('touchend', e => {
                    const touchEndX = e.changedTouches[0].clientX;
                    if (touchEndX < touchStartX - 50) manualSlide(1);
                    if (touchEndX > touchStartX + 50) manualSlide(-1);
                });
                showSlide(0);
            }
            
            async function initializeData() {
                try {
                    const aboutMeDoc = await db.collection('site_content').doc('about_me').get();
                    if (aboutMeDoc.exists) aboutMeContent = aboutMeDoc.data();
                    
                    const categoriesSnapshot = await db.collection('categories').get();
                    categories = {};
                    categoriesSnapshot.forEach(doc => { categories[doc.id] = doc.data(); });

                    const productsSnapshot = await db.collection('products').get();
                    products = {};
                    productsSnapshot.forEach(doc => { products[doc.id] = doc.data(); });
                    
                    renderNavigation();
                    renderProducts(); 
                    filterProducts('all');
                    renderAdminProducts();
                    renderCategories();
                    updateCategoryDropdown();
                    renderAdminAboutMe();

                } catch (error) { console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Firebase:", error); }
            }

            // --- –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –°–û–•–†–ê–ù–ï–ù–ò–Ø –¢–û–í–ê–†–ê –° –ê–í–¢–û-SLUG ---
            async function saveProduct(e) {
                e.preventDefault();
                const productTitle = document.getElementById('product-title').value;
                const productId = document.getElementById('product-id').value || Date.now().toString();
                const productSlug = generateSlug(productTitle);

                const productData = {
                    id: productId,
                    title: productTitle,
                    slug: productSlug,
                    category: document.getElementById('product-category').value,
                    images: document.getElementById('product-images').value.split('\n').map(url => url.trim()).filter(url => url),
                    description: document.getElementById('product-description').value,
                    features: document.getElementById('product-features').value.split('\n').filter(f => f.trim() !== ''),
                    price: document.getElementById('product-price').value
                };

                if (!productData.title || !productData.category) {
                    alert('Please fill in the Title and Category fields.'); return;
                }
                if (productData.images.length === 0) {
                    alert('Please provide at least one media URL.'); return;
                }

                try {
                    await db.collection('products').doc(productId).set(productData, { merge: true });
                    alert(`Product saved successfully!\nURL will be: /${productData.category}/${productData.slug}`);
                    resetProductForm();
                    await initializeData();
                } catch (error) {
                    console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞:", error);
                    alert("Error saving product. Check the console for details.");
                }
            }

            async function deleteProduct(productId) {
                if (confirm('Are you sure?')) {
                    try { await db.collection('products').doc(productId).delete(); await initializeData(); }
                    catch (error) { console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞:", error); }
                }
            }

            // --- –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø –°–û–•–†–ê–ù–ï–ù–ò–Ø –ö–ê–¢–ï–ì–û–†–ò–ò –° –ê–í–¢–û-SLUG ---
            async function saveCategory(e) {
                e.preventDefault();
                const categoryName = document.getElementById('category-name').value;
                const existingId = document.getElementById('category-id').value;
                const categoryId = existingId || generateSlug(categoryName);

                if (!categoryName) {
                    alert('Category name cannot be empty.'); return;
                }

                const categoryData = { id: categoryId, name: categoryName };

                try {
                    await db.collection('categories').doc(categoryId).set(categoryData);
                    if (existingId && existingId !== categoryId) {
                        await db.collection('categories').doc(existingId).delete();
                    }
                    resetCategoryForm();
                    await initializeData();
                } catch (error) {
                    console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:", error);
                    alert("Error saving category. Check the console for details.");
                }
            }

            async function deleteCategory(categoryId) {
                if (confirm('Are you sure?')) {
                     try { await db.collection('categories').doc(categoryId).delete(); await initializeData(); }
                     catch(error) { console.error("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:", error); }
                }
            }
            async function saveAboutMeContent(e) {
                e.preventDefault();
                const dataToSave = {
                    text: document.getElementById('about-me-text-input').value,
                    images: document.getElementById('about-me-images-input').value.split('\n').map(url => url.trim()).filter(url => url)
                };
                try {
                    await db.collection('site_content').doc('about_me').set(dataToSave);
                    alert('"About Me" content saved successfully!');
                    aboutMeContent = dataToSave;
                } catch (error) { console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è "About Me":', error); }
            }

            function renderNavigation() {
                const nav = document.querySelector('nav');
                nav.innerHTML = '';
                const showAllLink = document.createElement('a');
                showAllLink.href = '#';
                showAllLink.className = 'nav-link active';
                showAllLink.dataset.category = 'all';
                showAllLink.textContent = 'SHOW ALL';
                showAllLink.style.setProperty('--delay', 1);
                nav.appendChild(showAllLink);
                
                const aboutMeLink = document.createElement('a');
                aboutMeLink.href = 'about.html'; 
                aboutMeLink.className = 'nav-link';
                aboutMeLink.textContent = 'ABOUT ME';
                aboutMeLink.style.setProperty('--delay', 2);
                nav.appendChild(aboutMeLink);

                let delay = 3;
                Object.values(categories).forEach(category => {
                    const link = document.createElement('a');
                    link.href = '#';
                    link.className = 'nav-link';
                    link.dataset.category = category.id;
                    link.textContent = category.name;
                    link.style.setProperty('--delay', delay++);
                    nav.appendChild(link);
                });
                addNavigationListeners();
            }
            
            function addNavigationListeners() {
                document.querySelectorAll('.nav-link[data-category]').forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        const category = this.dataset.category;
                        document.querySelectorAll('.nav-link[data-category]').forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                        filterProducts(category);
                    });
                });
            }
            
            function createMediaElement(mediaUrl) {
                if (isYoutubeUrl(mediaUrl)) {
                    const embedUrl = getYoutubeEmbedUrl(mediaUrl);
                    if (embedUrl) {
                        const wrapper = document.createElement('div');
                        wrapper.className = 'slideshow-item slideshow-item-video';
                        const iframe = document.createElement('iframe');
                        iframe.src = embedUrl;
                        wrapper.appendChild(iframe);
                        return wrapper;
                    }
                } else {
                    const img = document.createElement('img');
                    img.src = mediaUrl;
                    img.className = 'slideshow-item';
                    return img;
                }
                return null;
            }
            
            function renderProducts() {
                const productsContainer = document.getElementById('products-container');
                productsContainer.innerHTML = '';
                let delay = 1;
                Object.entries(products).forEach(([id, product]) => {
                    if (!product.slug || !product.category) {
                        console.warn(`–¢–æ–≤–∞—Ä "${product.title}" –ø—Ä–æ–ø—É—â–µ–Ω, —Ç.–∫. —É –Ω–µ–≥–æ –Ω–µ—Ç slug –∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.`);
                        return;
                    }

                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    productCard.style.setProperty('--delay', delay++);
                    productCard.dataset.id = product.id;
                    productCard.dataset.category = product.category;
                    
                    const slideshowHTML = `<div class="slideshow-container product-image-container">${(product.images || []).map(mediaUrl => createMediaElement(mediaUrl)?.outerHTML || '').join('')}</div>`;
                    
                    const productInfoHTML = `
                        <div class="product-info">
                            <h3 class="product-title">${product.title}</h3>
                            <p class="product-price">${product.price}</p>
                            <a href="/${product.category}/${product.slug}" class="gold-button">VIEW DETAILS</a>
                        </div>
                    `;

                    productCard.innerHTML = slideshowHTML + productInfoHTML;
                    productsContainer.appendChild(productCard);

                    const newSlideshowContainer = productCard.querySelector('.slideshow-container');
                    if(newSlideshowContainer) setupSlideshow(newSlideshowContainer); 
                });
            }

            function filterProducts(category) {
                document.querySelectorAll('.product-card').forEach(card => {
                    const isVisible = category === 'all' || card.dataset.category === category;
                    card.style.display = isVisible ? '' : 'none';
                });
            }
            
            function renderAdminProducts() {
                const list = document.getElementById('admin-products-list');
                list.innerHTML = '';
                Object.values(products).forEach(product => {
                    const item = document.createElement('div');
                    item.className = 'admin-product-item';
                    item.innerHTML = `<div><strong>${product.title}</strong> (${categories[product.category]?.name || 'Uncategorized'})</div><div class="admin-product-actions"><button class="admin-product-edit" data-id="${product.id}">‚úèÔ∏è</button><button class="admin-product-delete" data-id="${product.id}">üóëÔ∏è</button></div>`;
                    list.appendChild(item);
                });
                list.querySelectorAll('.admin-product-edit').forEach(b => b.addEventListener('click', () => editProduct(b.dataset.id)));
                list.querySelectorAll('.admin-product-delete').forEach(b => b.addEventListener('click', () => deleteProduct(b.dataset.id)));
            }
            function renderCategories() {
                const list = document.getElementById('admin-categories-list');
                list.innerHTML = '';
                Object.values(categories).forEach(category => {
                    const item = document.createElement('div');
                    item.className = 'admin-category-item';
                    item.innerHTML = `<div><strong>${category.name}</strong></div><div class="admin-category-actions"><button class="admin-category-edit" data-id="${category.id}">‚úèÔ∏è</button><button class="admin-category-delete" data-id="${category.id}">üóëÔ∏è</button></div>`;
                    list.appendChild(item);
                });
                list.querySelectorAll('.admin-category-edit').forEach(b => b.addEventListener('click', () => editCategory(b.dataset.id)));
                list.querySelectorAll('.admin-category-delete').forEach(b => b.addEventListener('click', () => deleteCategory(b.dataset.id)));
            }
            function renderAdminAboutMe() {
                document.getElementById('about-me-text-input').value = aboutMeContent.text || '';
                document.getElementById('about-me-images-input').value = aboutMeContent.images ? aboutMeContent.images.join('\n') : '';
            }
            function updateCategoryDropdown() {
                const select = document.getElementById('product-category');
                select.innerHTML = '<option value="">Select category</option>';
                Object.values(categories).forEach(category => {
                    select.innerHTML += `<option value="${category.id}">${category.name}</option>`;
                });
            }
            function editProduct(productId) {
                const product = products[productId];
                document.getElementById('product-id').value = product.id;
                document.getElementById('product-title').value = product.title;
                document.getElementById('product-category').value = product.category;
                document.getElementById('product-images').value = (product.images || []).join('\n');
                document.getElementById('product-description').value = product.description;
                document.getElementById('product-features').value = (product.features || []).join('\n');
                document.getElementById('product-price').value = product.price;
                document.querySelector('.admin-tab[data-tab="products"]').click(); document.getElementById('product-title').focus();
            }
            function resetProductForm() { document.getElementById('product-form').reset(); document.getElementById('product-id').value = ''; }
            function editCategory(categoryId) {
                const category = categories[categoryId];
                document.getElementById('category-id').value = category.id;
                document.getElementById('category-name').value = category.name;
                document.querySelector('.admin-tab[data-tab="categories"]').click(); document.getElementById('category-name').focus();
            }
            function resetCategoryForm() { document.getElementById('category-form').reset(); document.getElementById('category-id').value = ''; }

            adminPanel.querySelector('.admin-tabs').addEventListener('click', (e) => {
                if(e.target.classList.contains('admin-tab')) {
                    adminPanel.querySelectorAll('.admin-tab, .admin-tab-content').forEach(el => el.classList.remove('active'));
                    e.target.classList.add('active');
                    adminPanel.querySelector(`#${e.target.dataset.tab}-tab`).classList.add('active');
                }
            });
            document.getElementById('about-me-form').addEventListener('submit', saveAboutMeContent);
            adminPanel.addEventListener('click', (e) => { if (e.target === adminPanel) adminPanel.classList.remove('active'); });
            document.getElementById('admin-close').addEventListener('click', () => adminPanel.classList.remove('active'));
            document.getElementById('product-form').addEventListener('submit', saveProduct);
            document.getElementById('product-cancel').addEventListener('click', resetProductForm);
            document.getElementById('category-form').addEventListener('submit', saveCategory);
            document.getElementById('category-cancel').addEventListener('click', resetCategoryForm);
            let passwordAttempts = 0;
            document.getElementById('admin-footer-trigger').addEventListener('click', (e) => {
                e.preventDefault();
                if (passwordAttempts >= 3) return;
                const password = prompt('Enter admin password:');
                if (password === 'NinoKartsivadze') {
                    adminPanel.classList.add('active');
                    passwordAttempts = 0;
                } else if(password !== null) { 
                    passwordAttempts++;
                    alert(`Incorrect password. Attempts left: ${3 - passwordAttempts}`);
                }
            });
            
            initializeData();
        };
    </script>
</body>
</html>